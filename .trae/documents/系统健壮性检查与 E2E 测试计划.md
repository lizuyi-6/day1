# 系统健壮性检查与 E2E 测试计划

为了满足企业级交付标准，我将执行以下全方位的质量保证计划。由于前端项目中缺少 Cypress/Playwright 等 E2E 测试框架，我将采用 **API 驱动的 E2E 测试** 方案，这是一种更高效且稳定的验证方式，能够覆盖从工作流编排到对话的完整链路。

## 1. 健壮性检查 (Static Analysis & Code Audit)
我将对系统进行一次全面的代码扫描，重点修复以下问题：
*   **资源泄漏**: 检查 Socket 连接、定时器（`setInterval`）是否在组件销毁时正确清理。
*   **错误处理**: 确保所有异步操作（API调用）都有 `try-catch` 包裹，并且有用户友好的错误提示。
*   **类型安全**: 检查 TypeScript 类型定义，减少 `any` 的使用，确保接口契约一致。
*   **边界条件**: 检查空数组、空对象、网络中断等边缘情况的处理（刚才修复的 `WorkflowView` 和 `ChatView` 已经是很好的开始）。

## 2. E2E 测试实施 (API-Driven)
我将创建一个自动化的测试脚本（使用 `api-test-pro` 代理或编写 Node.js 脚本），模拟真实用户的完整操作路径。
**测试场景 (The "Happy Path")**:
1.  **创建工作流**: 调用 API 创建一个新的测试工作流。
2.  **编排节点**: 模拟前端保存操作，向工作流添加 Start -> LLM -> End 节点结构。
3.  **部署工作流**: 调用部署接口。
4.  **运行工作流**: 通过 API 触发运行，并验证输出结果。
5.  **对话测试**: 模拟 Chat 界面，发送消息给该工作流，并验证 LLM 的响应。
6.  **清理数据**: 测试完成后删除测试数据。

## 3. 单元/集成测试补充
*   **后端**: 运行现有的 NestJS 测试套件 (`npm run test`)，确保基础服务逻辑无误。
*   **补充**: 针对 `WorkflowService` 的 `deploy` 和 `findAll`（含缓存逻辑）添加针对性测试用例。

---

## 执行步骤

1.  **代码审计**: 快速扫描 `frontend` 和 `backend` 关键文件，修复发现的健壮性问题。
2.  **后端测试运行**: 在终端运行 `npm run test` (backend)，查看当前测试状态。
3.  **E2E 脚本编写与执行**:
    *   创建一个 `scripts/e2e-test.ts` (在 backend 或根目录)，使用 `axios` 或 `supertest` 串联整个流程。
    *   执行该脚本，验证系统在真实流程下的表现。
4.  **报告输出**: 汇总测试结果，提供一份简要的“企业级发布测试报告”。